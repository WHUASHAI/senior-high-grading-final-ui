<p>Teacher subject id: {{ teacher_subject_id }}</p>
<!-- <p>Quarter: {{ quarter }}</p>
<p>type: {{ type }}</p> -->

<div class="border border-1 border-blackp p-2 mb-4">
  <h4 class="m-0">{{ quarter }}: {{ type }}</h4>
</div>

<div class="d-flex justify-content-between p-3">
  <!-- table -->
  <div style="width: 75%">
    <table class="table table-bordered table-sm">
      <thead>
        <tr>
          <td style="width: 2%">#</td>
          <th style="width: 10%">Perfect Score</th>
          <th style="width: 30%">Description</th>
          <th style="width: 10%">Edit Perfect Score</th>
          <th style="width: 10%">Update Scores</th>
          <th style="width: 10%">Delete Score</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let quiz of quizzes">
          <td>{{ quiz.id }}</td>
          <td>
            <div *ngIf="editingQuizId !== quiz.id; else editHps">
              {{ quiz.hps }}
            </div>
            <ng-template #editHps>
              <form [formGroup]="quizForms[quiz.id]">
                <input
                  type="number"
                  class="form-control form-control-sm"
                  formControlName="hps"
                />
              </form>
            </ng-template>
          </td>
          <!-- <td>{{ quiz.description }}</td> -->
          <td>
            <div *ngIf="editingQuizId !== quiz.id; else editDesc">
              {{ quiz.description }}
            </div>
            <ng-template #editDesc>
              <form [formGroup]="quizForms[quiz.id]">
                <textarea
                  class="form-control form-control-sm"
                  formControlName="description"
                  rows="1"
                  placeholder="Enter description"
                ></textarea>
              </form>
            </ng-template>
          </td>

          <td>
            <button
              *ngIf="editingQuizId !== quiz.id"
              class="btn btn-sm btn-info"
              (click)="onEdit(quiz)"
            >
              Edit
            </button>
            <button
              *ngIf="editingQuizId === quiz.id"
              class="btn btn-sm btn-success"
              (click)="updateQuiz(quiz)"
            >
              Save
            </button>
          </td>
          <td>
            <button class="btn btn-sm btn-primary">View</button>
          </td>
          <td>
            <button class="btn btn-sm btn-danger">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- add score -->
  <div style="width: 20%" class="pb-3 px-3">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <h4 class="mb-3">Add quiz</h4>
      <div class="mb-2 d-flex">
        <label class="form-label d-inline w-50">Perfect Score:</label>
        <input
          type="number"
          class="form-control form-control-sm w-50"
          [ngClass]="{ 'is-invalid': submitted && f.hps.errors }"
          formControlName="hps"
        />
      </div>
      <div *ngIf="submitted && f.hps.errors" class="invalid-feedback d-block">
        <div *ngIf="f.hps.errors.required">Perfect Score is required</div>
      </div>
      <div class="mb-2">
        <label class="form-label d-inline">Description:</label>
        <textarea
          class="form-control form-control-sm"
          [ngClass]="{
            'is-invalid': submitted && f.description.errors?.maxlength
          }"
          formControlName="description"
          rows="2"
          placeholder="Enter description"
        ></textarea>
        <div
          *ngIf="submitted && f.description.errors?.maxlength"
          class="invalid-feedback d-block"
        >
          <div>Description must not exceed 255 characters</div>
        </div>
      </div>

      <button [disabled]="loading" class="btn btn-primary">
        <span
          *ngIf="loading"
          class="spinner-border spinner-border-sm mr-1"
        ></span>
        Add quiz
      </button>
    </form>
  </div>
</div>
